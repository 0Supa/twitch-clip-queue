{"version":3,"sources":["components/ForkMeOnGithub.tsx","pages/Routes.tsx","App.tsx","reportWebVitals.ts","index.tsx","common/analytics.ts","common/logging.ts","services/TwitchApi.ts","store/dictionaries.ts","services/providers/twitch-clip.ts","services/providers/twitch-vod.ts","services/YoutubeApi.ts","services/providers/youtube.ts","services/StreamableApi.ts","services/providers/streamable.ts","services/ClipFinder.ts","services/TwitchAuth.ts","common/utils.ts","services/TwitchChat.ts","common/commands.ts","store/queue.ts","store/user.ts","store/helpers.ts"],"names":["ForkMeOnGithub","href","target","rel","title","className","xmlns","width","height","viewBox","fill","d","style","WebkitTransformOrigin","transformOrigin","HomePage","React","lazy","QueuePage","Routes","loggedIn","useState","isLoggedIn","get","fallback","basename","process","path","to","exact","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","TwitchAuth","processAuth","ReactDOM","render","StrictMode","document","getElementById","logger","createLogger","umami","window","eventQueue","trace","value","type","debug","push","e","shift","trackView","trackEvent","LogLevel","globalLogLevel","setLogLevel","level","info","ConsoleLogger","name","message","data","this","log","warn","error","messageWithName","console","__setLogLevel","TwitchApiClient","axios","create","baseURL","headers","TwitchApi","getClip","id","a","Authorization","accessToken","getVideo","getGame","gamesDictionary","createPersistentState","getGameName","dict","game","set","providerName","canHandle","url","uri","URL","hostname","endsWith","pathname","includes","tryGetClip","getInfo","fromMemory","getMemorizedClip","provider","clipInfo","broadcaster_name","game_id","thumbnail_url","split","created_at","channel","thumbnailUrl","videoUrl","timestamp","idStart","lastIndexOf","slice","TwitchClipProvider","startTime","user_name","replace","searchParams","TwitchVodProvider","YoutubeApi","undefined","author_name","YouTubeProvider","StreamableApi","StreamableProvider","providers","getEnabledProviders","enabledClipProviders","map","p","trim","ClipFinder","findByUrl","enabledProviders","clip","hash","Date","now","toString","getInfoByUrl","TWITCH_CLIENT_ID","getLoginUrl","encodeURI","redirectToLogin","location","assign","authInfo","substring","reduce","s","parts","decodeURIComponent","access_token","id_token","decodedIdToken","token","base64","jsonPayload","atob","c","charCodeAt","join","JSON","parse","parseJwt","logIn","preferred_username","revokeToken","post","getUrlFromMessage","urlStart","indexOf","urlEnd","client","commands","queuenext","nextClip","queueclose","acceptClips","queueopen","queueclear","clearQueue","queuepurgememory","clearMemory","queueautoplay","val","toggleAutoplay","queuesoftlimit","limit","Number","isInteger","setSoftClipLimit","queueremove","startsWith","removeClip","queueproviders","providerNames","replaceAll","handleTimeout","username","clipQueue","filter","submitter","userName","submitters","some","forEach","length","memory","clipMemory","find","same","none","disconnect","joinChannel","toLowerCase","TwitchChat","connect","Client","options","skipUpdatingEmotesets","skipMembership","messagesLogLevel","bind","identity","password","connection","reconnect","secure","on","reason","_channel","userstate","self","mod","badges","substr","commandName","args","command","acceptingClips","displayName","addClip","handleMessage","_username","handleMessageDeleted","userChannel","catch","setTimeout","leaveChannel","part","currentClip","createState","softClipLimit","softClipCount","autoplay","useReactPlayer","autoplayTimeoutHandle","addClipToMemory","stringify","queuedState","queued","queue","sort","b","uncount","next","Math","max","cancelDelayedNextClip","selectCurrentClip","getQueuedClip","index","findIndex","count","m","accept","reloadClip","ap","delayedNextClip","timeoutHandle","clearTimeout","idToken","auth","currentDate","getDay","Array","getDate","getMonth","logOut","changeChannel","initialValue","state","attach","Persistence"],"mappings":"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","file":"static/js/main.a30fa760.chunk.js","sourcesContent":["import React from 'react';\r\n\r\ninterface ForkMeOnGithubProps {\r\n  href: string;\r\n}\r\n\r\nfunction ForkMeOnGithub({ href }: ForkMeOnGithubProps) {\r\n  return (\r\n    <a href={href} target=\"_blank\" rel=\"noreferrer\" title=\"Fork me on GitHub\" className=\"opacity-40 hover:opacity-75\">\r\n      <svg\r\n        xmlns=\"http://www.w3.org/2000/svg\"\r\n        width=\"52\"\r\n        height=\"52\"\r\n        viewBox=\"0 0 250 250\"\r\n        className=\"absolute top-0 right-0\"\r\n        fill=\"#1f2937\"\r\n      >\r\n        <path d=\"M0 0l115 115h15l12 27 108 108V0z\" fill=\"#000\" />\r\n        <path\r\n          d=\"M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16\"\r\n          style={{ WebkitTransformOrigin: '130px 106px', transformOrigin: '130px 106px' }}\r\n        />\r\n        <path d=\"M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z\" />\r\n      </svg>\r\n    </a>\r\n  );\r\n}\r\n\r\nexport default ForkMeOnGithub;\r\n","import { useState } from '@hookstate/core';\nimport React from 'react';\nimport { Suspense } from 'react';\nimport { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom';\nimport { isLoggedIn } from '../store/user';\n\nconst HomePage = React.lazy(() => import('./Home/HomePage'));\nconst QueuePage = React.lazy(() => import('./Queue/QueuePage'));\n\nfunction Routes() {\n  const loggedIn = useState(isLoggedIn).get();\n\n  return (\n    <Suspense fallback={<div></div>}>\n      <Router basename={process.env.REACT_APP_BASEPATH}>\n        <Switch>\n          <Route path=\"/queue\">\n            {loggedIn ? <QueuePage /> : <Redirect to=\"/\" />}\n          </Route>\n          <Route exact={true} path=\"/\">\n            {!loggedIn ? <HomePage /> : <Redirect to=\"/queue\" />}\n          </Route>\n          <Route path=\"*\">\n            <Redirect to=\"/\" />\n          </Route>\n        </Switch>\n      </Router>\n    </Suspense>\n  );\n}\n\nexport default Routes;\n","import React from 'react';\r\nimport ForkMeOnGithub from './components/ForkMeOnGithub';\r\nimport Routes from './pages/Routes';\r\n\r\n\r\nfunction App() {\r\n  return (\r\n    <>\r\n      <ForkMeOnGithub href=\"https://github.com/JakeMiki/twitch-clip-queue\" />\r\n      <Routes />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport TwitchAuth from \"./services/TwitchAuth\";\r\n\r\nTwitchAuth.processAuth();\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n","import { createLogger } from \"./logging\";\n\nconst logger = createLogger('Umami Event');\n\nconst umami = (window as any).umami;\nconst eventQueue: { type: string; value: string; }[] = [];\n\nexport function trace(value: string, type = 'custom') {\n  logger.debug(`${type}: ${value}`);\n\n  try {\n    eventQueue.push({ type, value });\n\n    if (umami) {\n      let e;\n\n      // eslint-disable-next-line\n      while (e = eventQueue.shift()) {\n        if (e.type === 'view') {\n          umami.trackView(`${process.env.REACT_APP_BASEPATH}${e.value}`);\n        } else {\n          umami.trackEvent(e.value, e.type);\n        }\n      }\n    }\n  } catch {}\n}\n","\nenum LogLevel {\n  debug = 0,\n  info,\n  warn,\n  error,\n};\n\ntype LogLevels = keyof typeof LogLevel;\n\ntype LoggingFunction = (message: any, ...data: any[]) => void;\ninterface Logger {\n  debug: LoggingFunction;\n  info: LoggingFunction;\n  warn: LoggingFunction;\n  error: LoggingFunction;\n}\n\nlet globalLogLevel: LogLevel;\n\nconst setLogLevel = (level: LogLevels) => globalLogLevel = LogLevel[level] ?? LogLevel.info;\n\nclass ConsoleLogger implements Logger {\n  constructor(private name: string) {}\n\n  public debug(message: any, ...data: any[]): void {\n    this.log(LogLevel.debug, message, ...data);\n  }\n\n  public info(message: any, ...data: any[]): void {\n    this.log(LogLevel.info, message, ...data);\n  }\n\n  public warn(message: any, ...data: any[]): void {\n    this.log(LogLevel.warn, message, ...data);\n  }\n\n  public error(message: any, ...data: any[]): void {\n    this.log(LogLevel.error, message, ...data);\n  }\n\n  protected log(level: LogLevel, message: any, ...data: any[]): void {\n    if (level < globalLogLevel) {\n      return;\n    }\n\n    const messageWithName = `[${this.name}] ${message}`;\n\n    switch (level) {\n      case LogLevel.debug:\n        console.debug(messageWithName, ...data);\n        break;\n      case LogLevel.info:\n        console.info(messageWithName, ...data);\n        break;\n      case LogLevel.warn:\n        console.warn(messageWithName, ...data);\n        break;\n      case LogLevel.error:\n        console.error(messageWithName, ...data);\n        break;\n    }\n  }\n}\n\nsetLogLevel((process.env.REACT_APP_LOG_LEVEL) as LogLevels);\n(window as any).__setLogLevel = setLogLevel;\n\nexport function createLogger(name: string): Logger {\n  return new ConsoleLogger(name);\n}\n","import axios from 'axios';\r\nimport { TwitchClip, TwitchGame, TwitchVideo } from '../models';\r\nimport { accessToken } from '../store/user';\r\n\r\nconst TWITCH_CLIENT_ID = process.env.REACT_APP_TWITCH_CLIENT_ID;\r\n\r\nconst TwitchApiClient = axios.create({\r\n  baseURL: 'https://api.twitch.tv/helix/',\r\n  headers: {\r\n    'Client-ID': TWITCH_CLIENT_ID,\r\n  },\r\n});\r\n\r\nconst getClip = async (id: string): Promise<TwitchClip> => {\r\n  const { data } = await TwitchApiClient.get<{ data: TwitchClip[] }>(`clips?id=${id}`, {\r\n    headers: {\r\n      Authorization: `Bearer ${accessToken.get()}`,\r\n    },\r\n  });\r\n\r\n  return data.data[0];\r\n};\r\n\r\nconst getVideo = async (id: string): Promise<TwitchVideo> => {\r\n  const { data } = await TwitchApiClient.get<{ data: TwitchVideo[] }>(`videos?id=${id}`, {\r\n    headers: {\r\n      Authorization: `Bearer ${accessToken.get()}`,\r\n    },\r\n  });\r\n\r\n  return data.data[0];\r\n};\r\n\r\nconst getGame = async (id: string): Promise<TwitchGame> => {\r\n  const { data } = await TwitchApiClient.get<{ data: TwitchGame[] }>(`games?id=${id}`, {\r\n    headers: {\r\n      Authorization: `Bearer ${accessToken.get()}`,\r\n    },\r\n  });\r\n\r\n  return data.data[0];\r\n};\r\n\r\nconst TwitchApi = {\r\n  getClip,\r\n  getVideo,\r\n  getGame,\r\n};\r\n\r\nexport default TwitchApi;\r\n","import TwitchApi from \"../services/TwitchApi\";\r\nimport { createPersistentState } from \"./helpers\";\r\n\r\nconst gamesDictionary = createPersistentState('gamesDictionary', {} as Record<string, string>);\r\n\r\nexport const getGameName = async (id: string): Promise<string> => {\r\n  const dict = gamesDictionary.get();\r\n  if (dict[id]) {\r\n    return dict[id];\r\n  }\r\n\r\n  const game = await TwitchApi.getGame(id);\r\n\r\n  if (game) {\r\n    gamesDictionary.set(d => ({ ...d, [id]: game.name }));\r\n    return game.name;\r\n  }\r\n\r\n  return '';\r\n};\r\n","import { createLogger } from '../../common/logging';\nimport { Clip, ClipInfo, Provider } from '../../models';\nimport { getGameName } from '../../store/dictionaries';\nimport { getMemorizedClip } from '../../store/queue';\nimport TwitchApi from '../TwitchApi';\n\nconst providerName = 'twitch-clip';\nconst logger = createLogger(`${providerName} provider`);\n\nconst canHandle = (url: string): boolean => {\n  const uri = new URL(url);\n  if (uri.hostname === 'clips.twitch.tv') {\n    return true;\n  }\n\n  if (uri.hostname.endsWith('twitch.tv')) {\n    if (uri.pathname.includes('/clip/')) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nconst tryGetClip = async (url: string): Promise<Clip | undefined> => {\n  try {\n    const { id } = getInfo(url) ?? {};\n\n    if (!id) {\n      return;\n    }\n\n    const fromMemory = getMemorizedClip({\n      provider: providerName,\n      id,\n    });\n\n    if (fromMemory) {\n      return { ...fromMemory };\n    }\n\n    const clipInfo = await TwitchApi.getClip(id);\n\n    if (clipInfo) {\n      return {\n        id,\n        channel: clipInfo.broadcaster_name,\n        game: await getGameName(clipInfo.game_id),\n        provider: providerName,\n        thumbnailUrl: clipInfo.thumbnail_url,\n        videoUrl: clipInfo.thumbnail_url.split('-preview-')[0] + '.mp4',\n        title: clipInfo.title,\n        timestamp: clipInfo.created_at,\n      };\n    }\n  } catch(e) {\n    logger.error('tryGetClip', e);\n  }\n};\n\nconst getInfo = (url: string): ClipInfo | undefined => {\n  try {\n    const uri = new URL(url);\n    if (!canHandle(url)) {\n      return undefined;\n    }\n\n    const idStart = uri.pathname.lastIndexOf('/');\n    const id = uri.pathname.slice(idStart).split('?')[0].slice(1);\n\n    return {\n      id,\n      provider: providerName,\n    }\n  } catch(e) {\n    logger.error('getInfo', e);\n  }\n};\n\nconst TwitchClipProvider: Provider = {\n  canHandle,\n  tryGetClip,\n  getInfo,\n  name: providerName,\n};\n\nexport default TwitchClipProvider;\n","import { createLogger } from '../../common/logging';\nimport { Clip, ClipInfo, Provider } from '../../models';\nimport { getMemorizedClip } from '../../store/queue';\nimport TwitchApi from '../TwitchApi';\n\nconst providerName = 'twitch-vod';\nconst logger = createLogger(`${providerName} provider`);\n\nconst canHandle = (url: string): boolean => {\n  const uri = new URL(url);\n  if (uri.hostname.endsWith('twitch.tv')) {\n    if (uri.pathname.includes('/videos/')) {\n      return true;\n    }\n    if (uri.pathname.includes('/video/')) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nconst tryGetClip = async (url: string): Promise<Clip | undefined> => {\n  try {\n    const { id, startTime } = getInfo(url) ?? {};\n\n    if (!id) {\n      return;\n    }\n\n    const fromMemory = getMemorizedClip({\n      provider: providerName,\n      id,\n    });\n\n    if (fromMemory) {\n      return { ...fromMemory };\n    }\n\n    const clipInfo = await TwitchApi.getVideo(id);\n\n    if (clipInfo) {\n      return {\n        id,\n        channel: clipInfo.user_name,\n        provider: providerName,\n        thumbnailUrl: clipInfo.thumbnail_url.replace('%{width}x%{height}', '480x272'),\n        title: clipInfo.title,\n        startTime: startTime,\n        timestamp: clipInfo.created_at,\n      };\n    }\n  } catch (e) {\n    logger.error('tryGetClip', e);\n  }\n};\n\nconst getInfo = (url: string): ClipInfo | undefined => {\n  try {\n    const uri = new URL(url);\n    if (!canHandle(url)) {\n      return undefined;\n    }\n\n    const idStart = uri.pathname.lastIndexOf('/');\n    const id = uri.pathname.slice(idStart).split('?')[0].slice(1);\n    const startTime = uri.searchParams.get('t');\n\n    if (!startTime) {\n      return undefined;\n    }\n\n    return {\n      id,\n      provider: providerName,\n      startTime,\n    };\n  } catch (e) {\n    logger.error('getInfo', e);\n  }\n};\n\nconst TwitchVodProvider: Provider = {\n  canHandle,\n  tryGetClip,\n  getInfo,\n  name: providerName,\n};\n\nexport default TwitchVodProvider;\n","import axios from 'axios';\nimport { OEmbedVideoResponse } from '../models';\n\nconst getClip = async (id: string): Promise<OEmbedVideoResponse | undefined> => {\n  try {\n    const { data } = await axios.get(\n      `https://www.youtube.com/oembed?format=json&url=https://www.youtube.com/watch?v=${id}`\n    );\n    return data;\n  } catch {\n    return undefined;\n  }\n};\n\nconst YoutubeApi = {\n  getClip,\n};\n\nexport default YoutubeApi;\n","import { createLogger } from '../../common/logging';\nimport { Clip, ClipInfo, Provider } from '../../models';\nimport { getMemorizedClip } from '../../store/queue';\nimport YoutubeApi from '../YoutubeApi';\n\nconst providerName = 'youtube';\nconst logger = createLogger(`${providerName} provider`);\n\nconst canHandle = (url: string): boolean => {\n  const uri = new URL(url);\n  if (uri.hostname === 'youtu.be') {\n    return true;\n  }\n\n  if (uri.hostname.endsWith('youtube.com')) {\n    return true;\n  }\n\n  return false;\n};\n\nconst tryGetClip = async (url: string): Promise<Clip | undefined> => {\n  try {\n    const { id, startTime } = getInfo(url) ?? {};\n\n    if (!id) {\n      return;\n    }\n\n    const fromMemory = getMemorizedClip({\n      provider: providerName,\n      id,\n    });\n\n    if (fromMemory) {\n      return { ...fromMemory };\n    }\n\n    const clipInfo = await YoutubeApi.getClip(id);\n\n    return {\n      id,\n      channel: clipInfo?.author_name ?? 'YouTube',\n      thumbnailUrl: clipInfo?.thumbnail_url ?? `https://i.ytimg.com/vi/${id}/hqdefault.jpg`,\n      provider: providerName,\n      title: clipInfo?.title ?? id,\n      startTime,\n    };\n  } catch (e) {\n    logger.error('tryGetClip', e);\n  }\n};\n\nconst getInfo = (url: string): ClipInfo | undefined => {\n  try {\n    const uri = new URL(url);\n    if (!canHandle(url)) {\n      return undefined;\n    }\n\n    let id: string | undefined = undefined;\n    if (uri.hostname === 'youtu.be' || uri.pathname.includes('shorts')) {\n      const idStart = uri.pathname.lastIndexOf('/') + 1;\n      id = uri.pathname.slice(idStart).split('?')[0];\n    } else if (uri.hostname.endsWith('youtube.com')) {\n      id = uri.searchParams.get('v') ?? undefined;\n    }\n\n    if (!id) {\n      return undefined;\n    }\n\n    const startTime = uri.searchParams.get('t') ?? undefined;\n\n    return {\n      id,\n      provider: providerName,\n      startTime,\n    };\n  } catch (e) {\n    logger.error('getInfo', e);\n  }\n};\n\nconst YouTubeProvider: Provider = {\n  canHandle,\n  tryGetClip,\n  getInfo,\n  name: providerName,\n};\n\nexport default YouTubeProvider;\n","import axios from 'axios';\nimport { OEmbedVideoResponse } from '../models';\n\nconst getClip = async (id: string): Promise<OEmbedVideoResponse | undefined> => {\n  try {\n    const { data } = await axios.get(`https://api.streamable.com/oembed.json?url=https://streamable.com/${id}`);\n    return data;\n  } catch {\n    return undefined;\n  }\n};\n\nconst StreamableApi = {\n  getClip,\n};\n\nexport default StreamableApi;\n","import { createLogger } from '../../common/logging';\nimport { Clip, ClipInfo, Provider } from '../../models';\nimport { getMemorizedClip } from '../../store/queue';\nimport StreamableApi from '../StreamableApi';\n\nconst providerName = 'streamable';\nconst logger = createLogger(`${providerName} provider`);\n\nconst canHandle = (url: string): boolean => {\n  const uri = new URL(url);\n  if (uri.hostname.endsWith('streamable.com')) {\n    return true;\n  }\n\n  return false;\n};\n\nconst tryGetClip = async (url: string): Promise<Clip | undefined> => {\n  try {\n    const { id, startTime } = getInfo(url) ?? {};\n\n    if (!id) {\n      return;\n    }\n\n    const fromMemory = getMemorizedClip({\n      provider: providerName,\n      id,\n    });\n\n    if (fromMemory) {\n      return { ...fromMemory };\n    }\n\n    const clipInfo = await StreamableApi.getClip(id);\n\n    return {\n      id,\n      channel: clipInfo?.author_name ?? 'Streamable',\n      thumbnailUrl: clipInfo?.thumbnail_url,\n      provider: providerName,\n      title: clipInfo?.title ?? id,\n      startTime,\n    };\n  } catch (e) {\n    logger.error('tryGetClip', e);\n  }\n};\n\nconst getInfo = (url: string): ClipInfo | undefined => {\n  try {\n    const uri = new URL(url);\n    if (!canHandle(url)) {\n      return undefined;\n    }\n\n    const idStart = uri.pathname.lastIndexOf('/') + 1;\n    let id = uri.pathname.slice(idStart).split('?')[0];\n\n    if (!id) {\n      return undefined;\n    }\n\n    return {\n      id,\n      provider: providerName,\n    };\n  } catch (e) {\n    logger.error('getInfo', e);\n  }\n};\n\nconst StreamableProvider: Provider = {\n  canHandle,\n  tryGetClip,\n  getInfo,\n  name: providerName,\n};\n\nexport default StreamableProvider;\n","import { Clip, ClipInfo } from '../models';\nimport TwitchClipProvider from './providers/twitch-clip';\nimport TwitchVodProvider from './providers/twitch-vod';\nimport YouTubeProvider from './providers/youtube';\nimport StreamableProvider from './providers/streamable';\nimport { enabledClipProviders } from '../store/user';\n\nconst providers = {\n  [TwitchClipProvider.name]: TwitchClipProvider,\n  [TwitchVodProvider.name]: TwitchVodProvider,\n  [YouTubeProvider.name]: YouTubeProvider,\n  [StreamableProvider.name]: StreamableProvider,\n};\n\nconst getEnabledProviders = () => {\n  return enabledClipProviders.value.split(',').map(p => p.trim());\n}\n\n\nconst findByUrl = async (url: string): Promise<Clip | undefined> => {\n  const enabledProviders = getEnabledProviders();\n  for (const providerName of enabledProviders) {\n    const provider = providers[providerName];\n    if (!provider) {\n      continue;\n    }\n\n    if (!provider.canHandle(url)) {\n      continue;\n    }\n\n    const clip = await provider.tryGetClip(url);\n\n    if (clip) {\n      clip.hash = Date.now().toString();\n      return clip;\n    }\n  }\n\n  return undefined;\n};\n\nconst getInfoByUrl = (url: string): ClipInfo | undefined => {\n  const enabledProviders = getEnabledProviders();\n  for (const providerName of enabledProviders) {\n    const provider = providers[providerName];\n    if (!provider) {\n      continue;\n    }\n\n    const clipInfo = provider.getInfo(url);\n\n    if (clipInfo) {\n      return clipInfo;\n    }\n  }\n\n  return undefined;\n};\n\nconst ClipFinder = {\n  findByUrl,\n  getInfoByUrl,\n};\n\nexport default ClipFinder;\n","import axios from 'axios';\r\nimport { AuthInfo, IdToken } from '../models';\r\nimport { logIn } from '../store/user';\r\n\r\nconst TWITCH_CLIENT_ID = process.env.REACT_APP_TWITCH_CLIENT_ID;\r\nconst TWITCH_REDIRECT_URI = process.env.REACT_APP_TWITCH_REDIRECT_URI;\r\n\r\nconst getLoginUrl = (): string => {\r\n  return encodeURI(\r\n    `https://id.twitch.tv/oauth2/authorize?client_id=${TWITCH_CLIENT_ID}` +\r\n      `&redirect_uri=${TWITCH_REDIRECT_URI}` +\r\n      `&response_type=token id_token` +\r\n      `&scope=openid chat:read` +\r\n      `&claims={\"id_token\":{\"preferred_username\":null}}`\r\n  );\r\n};\r\n\r\nconst redirectToLogin = (): void => {\r\n  window.location.assign(getLoginUrl());\r\n};\r\n\r\nconst processAuth = (): void => {\r\n  if (!window.location.hash) {\r\n    return;\r\n  }\r\n\r\n  const authInfo = window.location.hash\r\n    .substring(1)\r\n    .split('&')\r\n    .reduce((authInfo, s) => {\r\n      const parts = s.split('=');\r\n      authInfo[parts[0]] = decodeURIComponent(decodeURIComponent(parts[1]));\r\n      return authInfo;\r\n    }, {} as Record<string, any>) as AuthInfo;\r\n\r\n  window.location.hash = '';\r\n\r\n  if (authInfo.access_token && authInfo.id_token) {\r\n    authInfo.decodedIdToken = parseJwt(authInfo.id_token) as IdToken;\r\n\r\n    logIn(authInfo.access_token, authInfo.id_token, authInfo.decodedIdToken?.preferred_username ?? '');\r\n  }\r\n};\r\n\r\nconst revokeToken = async (token: string): Promise<void> => {\r\n  await axios.post(`https://id.twitch.tv/oauth2/revoke?client_id=${TWITCH_CLIENT_ID}&token=${token}`);\r\n};\r\n\r\nfunction parseJwt(token: string) {\r\n  if (!token) {\r\n    return;\r\n  }\r\n\r\n  var base64Url = token.split('.')[1];\r\n  var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n  var jsonPayload = decodeURIComponent(\r\n    atob(base64)\r\n      .split('')\r\n      .map(function (c) {\r\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n      })\r\n      .join('')\r\n  );\r\n\r\n  return JSON.parse(jsonPayload);\r\n}\r\n\r\nconst TwitchAuth = {\r\n  getLoginUrl,\r\n  redirectToLogin,\r\n  processAuth,\r\n  revokeToken,\r\n};\r\n\r\nexport default TwitchAuth;\r\n","export const getUrlFromMessage = (message: string) => {\n\n  const urlStart = message.indexOf('http');\n  if (urlStart >= 0) {\n    const urlEnd = message.indexOf(' ', urlStart);\n    const url = message.slice(urlStart, urlEnd > 0 ? urlEnd : undefined);\n    return url;\n  }\n\n  return undefined;\n};\n","import { createLogger } from '../common/logging';\nimport { getUrlFromMessage } from '../common/utils';\nimport { acceptingClips, addClip, clipMemory, clipQueue, removeClip } from '../store/queue';\nimport { accessToken, userChannel, userName } from '../store/user';\nimport { Client, Userstate } from 'tmi.js';\nimport ClipFinder from './ClipFinder';\nimport { none } from '@hookstate/core';\nimport { commands } from '../common/commands';\nimport { same } from '../store/helpers';\n\nconst logger = createLogger('Twitch Chat');\nlet client: Client;\n\nconst handleMessage = (userstate: Userstate, message: string, self: boolean) => {\n  if (message.startsWith('!')) {\n    logger.debug('Userstate', userstate);\n    if (!userstate.mod && userstate.badges?.['broadcaster'] !== '1') {\n      return;\n    }\n\n    const [commandName, ...args] = message.substr(1).split(' ');\n\n    const command = commands[commandName];\n    if (!command) {\n      return;\n    }\n\n    command(...args);\n    return;\n  }\n\n  if (!acceptingClips.get() && !self) {\n    return;\n  }\n\n  const url = getUrlFromMessage(message);\n\n  if (url) {\n    logger.debug('[handleMessage] Found url:', url);\n\n    ClipFinder.findByUrl(url).then((clip) => {\n      if (clip) {\n        clip.url = url;\n        clip.submitter = {\n          userName: userstate.username,\n          displayName: userstate['display-name'],\n        };\n        addClip(clip);\n      }\n    });\n  }\n};\n\nconst handleMessageDeleted = (message: string) => {\n  const url = getUrlFromMessage(message);\n\n  if (url) {\n    logger.debug('[handleMessageDeleted] Found url:', url);\n\n    ClipFinder.findByUrl(url).then((clip) => {\n      if (clip) {\n        removeClip(clip);\n      }\n    });\n  }\n};\n\nconst handleTimeout = (username: string) => {\n  const clipsFromUser = clipQueue.filter(\n    (clip) => clip.submitter.get()?.userName === username || clip.submitters.get()?.some((s) => s.userName === username)\n  );\n\n  clipsFromUser.forEach((clip) => {\n    if (clip.submitter.get()?.userName === username) {\n      if (!clip.submitters.get()?.length) {\n        const memory = clipMemory.find((c) => same(c.get(), clip.get()));\n        memory?.set(none);\n        clip.set(none);\n      } else {\n        clip.submitter.set(clip.submitters.get()?.[0]);\n        clip.submitters.set((submitters) => {\n          submitters?.shift();\n          return submitters;\n        });\n      }\n    } else {\n      clip.submitters.set((submitters) => submitters?.filter((s) => s.userName !== username));\n    }\n  });\n};\n\nconst connect = () => {\n  client = new Client({\n    options: {\n      debug: process.env.REACT_APP_LOG_LEVEL === 'debug',\n      skipUpdatingEmotesets: true,\n      skipMembership: true,\n      messagesLogLevel: 'debug'\n    } as any,\n    logger: {\n      error: logger.error.bind(logger),\n      info: logger.info.bind(logger),\n      warn: logger.warn.bind(logger),\n      debug: logger.debug.bind(logger),\n    } as any,\n    identity: {\n      username: userName.get() as string,\n      password: `oauth:${accessToken.get()}`,\n    },\n    connection: {\n      reconnect: true,\n      secure: true,\n    },\n  });\n\n  client.on('disconnected', (reason) => logger.info('Disconnected:', reason));\n  client.on('message', (_channel, userstate, message, self) => handleMessage(userstate, message, self));\n  client.on('messagedeleted', (_channel, _username, message) => handleMessageDeleted(message));\n  client.on('timeout', (_channel, username) => handleTimeout(username));\n  client.on('ban', (_channel, username) => handleTimeout(username));\n\n  logger.info('Connecting and authenticating...');\n  client\n    .connect()\n    .then(() => {\n      logger.info('Connected.');\n      joinChannel(userChannel.get() ?? userName.get() ?? '');\n    })\n    .catch((error) => {\n      logger.error(error);\n      setTimeout(() => connect(), 5000);\n    });\n};\n\nconst disconnect = async () => {\n  await client?.disconnect();\n};\n\nconst joinChannel = async (channel: string) => {\n  logger.info('Joining channel', channel);\n  await client.join(channel.toLowerCase());\n};\n\nconst leaveChannel = async (channel: string) => {\n  logger.info('Leaving channel', channel);\n  await client.part(channel.toLowerCase());\n};\n\nconst TwitchChat = {\n  connect,\n  disconnect,\n  joinChannel,\n  leaveChannel,\n};\n\nexport default TwitchChat;\n","import ClipFinder from '../services/ClipFinder';\nimport {\n  acceptClips,\n  clearMemory,\n  clearQueue,\n  nextClip,\n  removeClip,\n  setSoftClipLimit,\n  toggleAutoplay,\n} from '../store/queue';\nimport { enabledClipProviders } from '../store/user';\n\nconst queueremove: (url: string) => void = (url) => {\n  if (!url) {\n    return;\n  }\n\n  if (url.startsWith('http')) {\n    const clipInfo = ClipFinder.getInfoByUrl(url);\n    if (clipInfo) {\n      removeClip(clipInfo);\n    }\n  }\n};\n\nexport const commands: Record<string, (...args: string[]) => void> = {\n  queuenext: () => nextClip(),\n  queueclose: () => acceptClips(false),\n  queueopen: () => acceptClips(true),\n  queueclear: () => clearQueue(),\n  queuepurgememory: () => clearMemory(),\n  queueautoplay: (val) =>\n    toggleAutoplay(['1', 'on', 'true'].includes(val) ? true : ['0', 'off', 'false'].includes(val) ? false : undefined),\n  queuesoftlimit: (limit) => limit !== null && Number.isInteger(+limit) && setSoftClipLimit(+limit),\n  queueremove,\n  queueproviders: (...providers) => {\n    const providerNames = providers.map((p) => p.replaceAll(',', '').trim()).join(', ');\n    enabledClipProviders.set(providerNames);\n  },\n};\n","import { createState, none } from '@hookstate/core';\nimport { trace } from '../common/analytics';\nimport { Clip, ClipInfo, ClipSubmitter } from '../models';\nimport { createPersistentState, same } from './helpers';\n\nexport const currentClip = createState({} as Clip);\nexport const clipQueue = createPersistentState('clipQueue', [] as Clip[]);\nexport const clipMemory = createPersistentState('clipMemory', [] as Clip[]);\nexport const acceptingClips = createState(false);\nexport const softClipLimit = createPersistentState('softClipLimit', 0);\nexport const softClipCount = createState(0);\nexport const autoplay = createPersistentState('autoplay', false);\nexport const useReactPlayer = createState(false);\nexport const autoplayTimeoutHandle = createState(-1);\n\nconst addClipToMemory = (clip: Clip): void => {\n  if (clip) {\n    clipMemory.set((memory) => [JSON.parse(JSON.stringify(clip)), ...(memory ?? [])]);\n  }\n};\n\nexport const addClip = (clip: Clip): void => {\n  const queuedState = clipQueue.find((c) => same(c.get(), clip));\n  const queued = queuedState?.get();\n  const limit = softClipLimit.get();\n\n  if (queued) {\n    const sameSubmitter =\n      queued.submitter?.userName === clip.submitter?.userName ||\n      (queued.submitters?.find((s) => s.userName === clip.submitter?.userName) ?? false);\n\n    if (!sameSubmitter) {\n      queuedState?.submitters.set((submitters) => [...(submitters ?? []), clip.submitter as ClipSubmitter]);\n      clipQueue.set((queue) => queue.sort((a, b) => (b.submitters?.length ?? 0) - (a.submitters?.length ?? 0)));\n    }\n\n    return;\n  } else if (limit && softClipCount.get() >= limit) {\n    return;\n  } else if (getMemorizedClip(clip)) {\n    return;\n  }\n\n  clipQueue.set((queue) => [...(queue ?? []), clip]);\n  softClipCount.set((c) => c + 1);\n\n  trace('clip-added');\n};\n\nexport const nextClip = (uncount = false): void => {\n  const next = clipQueue[0]?.get();\n  currentClip.set(JSON.parse(JSON.stringify(next ?? {})));\n  addClipToMemory(next);\n  clipQueue[0].set(none);\n\n  if (uncount) {\n    softClipCount.set((c) => Math.max(c - 1, 0));\n  }\n\n  useReactPlayer.set(autoplay.get());\n  cancelDelayedNextClip();\n\n  if (next) {\n    trace('next-clip');\n    trace('?visit-time-extender', 'view');\n  }\n};\n\nexport const getMemorizedClip = (clip: ClipInfo): Clip | undefined => {\n  const queue = clipQueue.find((c) => same(c.get(), clip));\n  if (queue) {\n    return queue?.get();\n  }\n  const memory = clipMemory.find((c) => same(c.get(), clip));\n  if (memory) {\n    return memory?.get();\n  }\n  return undefined;\n};\n\nexport const getQueuedClip = (clip: ClipInfo): Clip | undefined => {\n  const queue = clipQueue.find((c) => same(c.get(), clip));\n  return queue?.get();\n};\n\nexport const selectCurrentClip = (clip: Clip): void => {\n  const queued = getQueuedClip(clip);\n  if (queued) {\n    useReactPlayer.set(autoplay.get());\n    currentClip.set(JSON.parse(JSON.stringify(queued)));\n    removeClip(queued);\n  }\n};\n\nexport const removeClip = (clip: ClipInfo): void => {\n  const index = clipQueue.findIndex((c) => same(c.get(), clip));\n  addClipToMemory(clipQueue[index].get());\n  clipQueue[index].set(none);\n  softClipCount.set((c) => Math.max(c - 1, 0));\n};\n\nexport const clearQueue = (): void => {\n  clipQueue.set([]);\n  currentClip.set({});\n  softClipCount.set(0);\n\n  trace('clear-queue');\n};\n\nexport const clearMemory = (count?: number): void => {\n  if (!count) {\n    clipMemory.set([]);\n  } else {\n    clipMemory.set((m) => m.slice(0, -count));\n  }\n\n  trace('purge-memory');\n};\n\nexport const acceptClips = (accept: boolean): void => {\n  acceptingClips.set(accept);\n  if (accept) {\n    softClipCount.set(clipQueue.length);\n  }\n\n  trace(`accept-clips-${accept}`);\n};\n\nexport const reloadClip = (): void => {\n  currentClip.hash.set(() => Date.now().toString());\n};\n\nexport const setSoftClipLimit = (limit: number): void => {\n  softClipLimit.set(limit);\n\n  trace('set-soft-limit');\n};\n\nexport const toggleAutoplay = (ap?: boolean): void => {\n  ap = ap ?? !autoplay.get();\n  autoplay.set(ap);\n\n  if (ap) {\n    useReactPlayer.set(true);\n  } else {\n    cancelDelayedNextClip();\n  }\n\n  trace(`toggle-autoplay-${ap}`);\n};\n\nexport const delayedNextClip = (): void => {\n  cancelDelayedNextClip();\n\n  const timeoutHandle = setTimeout(() => nextClip(), 1000) as unknown as number;\n  autoplayTimeoutHandle.set(timeoutHandle);\n};\n\nexport const cancelDelayedNextClip = (): void => {\n  let timeoutHandle = autoplayTimeoutHandle.get();\n  if (timeoutHandle) {\n    clearTimeout(timeoutHandle);\n  }\n};\n","import { createState } from \"@hookstate/core\";\nimport { trace } from \"../common/analytics\";\nimport TwitchAuth from \"../services/TwitchAuth\";\nimport TwitchChat from \"../services/TwitchChat\";\nimport { createPersistentState } from \"./helpers\";\nimport { currentClip } from \"./queue\";\n\nexport const isLoggedIn = createState<boolean>(false);\n\nexport const accessToken = createState<string | null>(null);\nexport const idToken = createState<string | null>(null);\n\nexport const userName = createState<string | null>(null);\nexport const userChannel = createPersistentState<string | null>('userChannel', null);\n\nexport const enabledClipProviders = createPersistentState<string>('enabledClipProviders', 'twitch-clip, twitch-vod, youtube');\n\nexport const logIn = (auth: string, id: string, username: string): void => {\n  accessToken.set(auth);\n  idToken.set(id);\n  userName.set(username);\n\n  let channel = userChannel.get();\n\n  if (!channel) {\n    userChannel.set(username);\n    channel = username;\n  }\n\n  isLoggedIn.set(true);\n\n  trace('user-logged-in');\n\n  // temp easter egg\n  if (channel?.toLowerCase() === 'wolfabelle') {\n    const currentDate = new Date();\n    if (currentDate.getDay() === 5) {\n      currentClip.set({\n        title: 'ITS FRIDAY THEN, ITS SATURDAY, SUNDAY! GO MUFASA!',\n        channel: 'MUFASA',\n        id: '1TewCPi92ro',\n        provider: 'youtube',\n        thumbnailUrl: 'https://i.ytimg.com/vi/1TewCPi92ro/hqdefault.jpg',\n        submitter: { displayName: 'Friday', userName: '' },\n        submitters: new Array(69420),\n        game: 'Friday',\n      })\n    }\n    if (currentDate.getDate() === 18 && currentDate.getMonth() === 3) {\n      currentClip.set({\n        title: `HAPPY BIRTHDAY BELLE! 🎂🎉🎉`,\n        channel: 'FeelsBirthdayMan Clap @Wolfabelle',\n        id: 'reLU2dEWnVU',\n        provider: 'youtube',\n        thumbnailUrl: 'https://i.ytimg.com/vi/reLU2dEWnVU/hqdefault.jpg',\n        submitter: { displayName: 'all of chat and their mums', userName: '' },\n        submitters: [],\n      })\n    }\n  }\n  //\n}\n\nexport const logOut = async (): Promise<void> => {\n  const token = accessToken.get();\n  accessToken.set(null);\n  idToken.set(null);\n  userName.set(null);\n  isLoggedIn.set(false);\n\n  if (token) {\n    await TwitchAuth.revokeToken(token);\n  }\n\n  trace('user-logged-out');\n}\n\nexport const changeChannel = (channel: string) => {\n  TwitchChat.leaveChannel(userChannel.get() as string);\n  userChannel.set(channel);\n  TwitchChat.joinChannel(channel);\n\n  trace('channel-changed');\n};\n","import { createState, State } from '@hookstate/core';\r\nimport { Persistence } from '@hookstate/persistence';\r\nimport { ClipInfo } from '../models';\r\n\r\nexport function createPersistentState<TState>(\r\n  name: string,\r\n  initialValue: TState\r\n): State<TState> {\r\n  const state = createState(initialValue);\r\n  state.attach(Persistence(name))\r\n  return state;\r\n}\r\n\r\nexport function same(a: ClipInfo, b: ClipInfo) {\r\n  return a.id === b.id && a.provider === b.provider;\r\n}\r\n"],"sourceRoot":""}
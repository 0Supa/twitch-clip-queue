(this["webpackJsonptwitch-clip-queue"]=this["webpackJsonptwitch-clip-queue"]||[]).push([[0],{12:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n(15),c=n(41);function a(t,e){return Object(r.a)(e,[Object(c.a)(t)])}function i(t,e){return t.id===e.id&&t.provider===e.provider}},13:function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"h",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"j",(function(){return p})),n.d(e,"i",(function(){return h})),n.d(e,"c",(function(){return b})),n.d(e,"b",(function(){return v}));var r=n(19),c=n(11),a=n(12),i=Object(a.a)("currentClip",{}),u=Object(a.a)("clipQueue",[]),o=Object(a.a)("clipMemory",[]),s=function(t){var e,n,i=f(t);if(i){if(!(i.submitter===t.submitter||null!==(e=null===(n=i.submitters)||void 0===n?void 0:n.includes(t.submitter))&&void 0!==e&&e)){var s,l=Object(c.a)(Object(c.a)({},i),{},{submitters:[].concat(Object(r.a)(null!==(s=null===i||void 0===i?void 0:i.submitters)&&void 0!==s?s:[]),[t.submitter])});u.set((function(t){return t.map((function(t){return Object(a.b)(t,l)?l:t})).sort((function(t,e){var n,r,c,a;return(null!==(n=null===(r=e.submitters)||void 0===r?void 0:r.length)&&void 0!==n?n:0)-(null!==(c=null===(a=t.submitters)||void 0===a?void 0:a.length)&&void 0!==c?c:0)}))}))}}else d(t)||(o.set((function(e){return[].concat(Object(r.a)(null!==e&&void 0!==e?e:[]),[t])})),u.set((function(e){return[].concat(Object(r.a)(null!==e&&void 0!==e?e:[]),[t])})))},l=function(){u.set((function(t){var e=(null!==t&&void 0!==t?t:[]).shift();return i.set(null!==e&&void 0!==e?e:{}),Object(r.a)(t)}))},d=function(t){var e,n=o.get();return null!==(e=null===n||void 0===n?void 0:n.find((function(e){return Object(a.b)(e,t)})))&&void 0!==e?e:void 0},f=function(t){var e,n=u.get();return null!==(e=null===n||void 0===n?void 0:n.find((function(e){return Object(a.b)(e,t)})))&&void 0!==e?e:void 0},p=function(t){var e=f(t);e&&(i.set(e),h(e))},h=function(t){u.set((function(e){return e.filter((function(e){return!Object(a.b)(e,t)}))}))},b=function(){u.set([]),i.set({})},v=function(){var t;o.set(Object(r.a)(null!==(t=u.get())&&void 0!==t?t:[]))}},16:function(t,e,n){"use strict";var r=n(1),c=n.n(r),a=n(5),i=n(17),u=n.n(i),o=n(9),s="ryrnsuk3r4howfd6jac8lamdan279v",l=function(){return encodeURI("https://id.twitch.tv/oauth2/authorize?client_id=".concat(s)+"&redirect_uri=".concat("https://jakemiki.github.io/twitch-clip-queue/")+'&response_type=token id_token&scope=openid chat:read&claims={"id_token":{"preferred_username":null}}')};var d={getLoginUrl:l,redirectToLogin:function(){window.location.assign(l())},processAuth:function(){if(window.location.hash){var t,e,n=window.location.hash.substring(1).split("&").reduce((function(t,e){var n=e.split("=");return t[n[0]]=decodeURIComponent(decodeURIComponent(n[1])),t}),{});if(window.location.hash="",n.access_token&&n.id_token)n.decodedIdToken=function(t){if(!t)return;var e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(e).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)}(n.id_token),Object(o.d)(n.access_token,n.id_token,null!==(t=null===(e=n.decodedIdToken)||void 0===e?void 0:e.preferred_username)&&void 0!==t?t:"")}},revokeToken:function(){var t=Object(a.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.post("https://id.twitch.tv/oauth2/revoke?client_id=".concat(s,"&token=").concat(e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};e.a=d},25:function(t,e,n){"use strict";var r=n(13),c=n(9),a=n(1),i=n.n(a),u=n(38),o=n(5),s=n(11),l=n(22),d=n(17),f=n.n(d),p=f.a.create({baseURL:"https://api.twitch.tv/helix/",headers:{"Client-ID":"ryrnsuk3r4howfd6jac8lamdan279v"}}),h={getClip:function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.get("clips?id=".concat(e),{headers:{Authorization:"Bearer ".concat(c.a.get())}});case 2:return n=t.sent,r=n.data,t.abrupt("return",r.data[0]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getGame:function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.get("games?id=".concat(e),{headers:{Authorization:"Bearer ".concat(c.a.get())}});case 2:return n=t.sent,r=n.data,t.abrupt("return",r.data[0]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},b=n(12),v=Object(b.a)("gamesDictionary",{}),m=function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=v.get())[e]){t.next=3;break}return t.abrupt("return",n[e]);case 3:return t.next=5,h.getGame(e);case 5:if(!(r=t.sent)){t.next=9;break}return v.set((function(t){return Object(s.a)(Object(s.a)({},t),{},Object(l.a)({},e,r.name))})),t.abrupt("return",r.name);case 9:return t.abrupt("return","");case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(t){var e=new URL(t);return"clips.twitch.tv"===e.hostname||!(!e.hostname.endsWith("twitch.tv")||!e.pathname.includes("/clip/"))},O=function(){var t=Object(o.a)(i.a.mark((function t(e){var n,c,a,u,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=new URL(e),j(e)){t.next=4;break}return t.abrupt("return");case 4:if(c=n.pathname.lastIndexOf("/"),a=n.pathname.slice(c).split("?")[0].slice(1),!(u=Object(r.g)({provider:"twitch-clip",id:a}))){t.next=9;break}return t.abrupt("return",Object(s.a)({},u));case 9:return t.next=11,h.getClip(a);case 11:if(!(o=t.sent)){t.next=21;break}return t.t0=a,t.t1=o.broadcaster_name,t.next=17,m(o.game_id);case 17:return t.t2=t.sent,t.t3=o.thumbnail_url,t.t4=o.title,t.abrupt("return",{id:t.t0,channel:t.t1,game:t.t2,provider:"twitch-clip",thumbnailUrl:t.t3,title:t.t4});case 21:t.next=25;break;case 23:t.prev=23,t.t5=t.catch(0);case 25:case"end":return t.stop()}}),t,null,[[0,23]])})));return function(e){return t.apply(this,arguments)}}(),g={canHandle:j,tryGetClip:O},w={getClip:function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.a.get("https://www.youtube.com/oembed?format=json&url=https://www.youtube.com/watch?v=".concat(e));case 3:return n=t.sent,r=n.data,t.abrupt("return",r);case 8:return t.prev=8,t.t0=t.catch(0),t.abrupt("return",void 0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},x=function(t){var e=new URL(t);return"youtu.be"===e.hostname||!!e.hostname.endsWith("youtube.com")},k=function(){var t=Object(o.a)(i.a.mark((function t(e){var n,c,a,u,o,l,d,f,p,h,b;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,o=new URL(e),x(e)){t.next=4;break}return t.abrupt("return");case 4:if(l=void 0,"youtu.be"===o.hostname?(d=o.pathname.lastIndexOf("/")+1,l=o.pathname.slice(d).split("?")[0]):o.hostname.endsWith("youtube.com")&&(l=null!==(f=o.searchParams.get("v"))&&void 0!==f?f:void 0),l){t.next=8;break}return t.abrupt("return");case 8:if(p=null!==(n=o.searchParams.get("t"))&&void 0!==n?n:void 0,!(h=Object(r.g)({provider:"youtube",id:l}))){t.next=12;break}return t.abrupt("return",Object(s.a)({},h));case 12:return t.next=14,w.getClip(l);case 14:return b=t.sent,t.abrupt("return",{id:l,channel:null!==(c=null===b||void 0===b?void 0:b.author_name)&&void 0!==c?c:"YouTube",thumbnailUrl:null!==(a=null===b||void 0===b?void 0:b.thumbnail_url)&&void 0!==a?a:"https://i.ytimg.com/vi/".concat(l,"/hqdefault.jpg"),provider:"youtube",title:null!==(u=null===b||void 0===b?void 0:b.title)&&void 0!==u?u:l,startTime:p});case 18:t.prev=18,t.t0=t.catch(0);case 20:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e){return t.apply(this,arguments)}}(),y=[g,{canHandle:x,tryGetClip:k}],C=function(){var t=Object(o.a)(i.a.mark((function t(e){var n,r,c,a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(u.a)(y),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=14;break}if((c=r.value).canHandle(e)){t.next=7;break}return t.abrupt("continue",12);case 7:return t.next=9,c.tryGetClip(e);case 9:if(!(a=t.sent)){t.next=12;break}return t.abrupt("return",a);case 12:t.next=3;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),n.e(t.t0);case 19:return t.prev=19,n.f(),t.finish(19);case 22:return t.abrupt("return",void 0);case 23:case"end":return t.stop()}}),t,null,[[1,16,19,22]])})));return function(e){return t.apply(this,arguments)}}();window.clip=function(){var t=Object(o.a)(i.a.mark((function t(e,n){var c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,C(n);case 2:(c=t.sent)&&(console.log("adding clip",c),c.submitter=e,Object(r.a)(c));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();var T,_={findByUrl:C},I=function(t){T.send(t)},U=function(t){console.log("[TwitchChat] Joining channel",t),I("JOIN #".concat(t))},L={connect:function(){(T=new WebSocket("wss://irc-ws.chat.twitch.tv:443","irc")).onopen=function(){null!==T&&1===T.readyState&&(console.log("[TwitchChat] Connecting and authenticating..."),I("CAP REQ :twitch.tv/tags"),I("PASS oauth:".concat(c.a.get())),I("NICK ".concat(c.g.get())),U(c.f.get()))},T.onclose=function(){console.log("[TwitchChat] Disconnected")},T.onerror=function(t){console.warn("[TwitchChat] Error:",t)},T.onmessage=function(t){var e=t.data;e.startsWith("PING")&&I("PONG :tmi.twitch.tv");var n=function(t){var e="@"===t[0]?t.indexOf(" "):-1,n=t.indexOf(" ",e+1),r=t.indexOf(" ",n+1),c=e>0?t.slice(1,e).split(";").reduce((function(t,e){var n=e.split("=",2);return t[n[0]]=n[1],t}),{}):{},a=t.slice(e+2,t.indexOf("!",e+2)),i=t.slice(n+1,r);if("PRIVMSG"===i){var u=t.indexOf(" ",r+1),o=t.indexOf(":",u+1),s=t.slice(r+2,u),l=t.slice(o+1).trim();return{channel:s,user:c["display-name"]||a,command:i,message:l,tags:c}}return{raw:t,user:c["display-name"]||a,command:i,tags:c}}(e);if("PRIVMSG"===n.command&&n.message){var c=n.message.indexOf("http");if(c>=0){var a=n.message.indexOf(" ",c),i=n.message.slice(c,a>0?a:void 0);console.log("[TwitchChat] Found url:",i),_.findByUrl(i).then((function(t){t&&(t.submitter=n.user,Object(r.a)(t))}))}}}},disconnect:function(){T.close()},joinChannel:U,leaveChannel:function(t){console.log("[TwitchChat] Leaving channel",t),I("PART #".concat(t))}};e.a=L},47:function(t,e,n){},73:function(t,e,n){"use strict";n.r(e);var r=n(0),c=n.n(r),a=n(37),i=n.n(a),u=(n(47),n(39)),o=n(3),s=n(16),l=n(9),d=n(2),f=c.a.lazy((function(){return n.e(3).then(n.bind(null,78))})),p=c.a.lazy((function(){return n.e(4).then(n.bind(null,77))}));var h=function(){var t=l.c.use();return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("header",{className:"flex",children:[Object(d.jsx)("h1",{className:"mb-4",children:"Twitch Clip Queue"}),Object(d.jsx)("div",{className:"flex-grow"}),Object(d.jsx)("div",{children:t?Object(d.jsx)("button",{onClick:function(){return Object(l.e)()},children:"Logout"}):Object(d.jsx)("button",{onClick:function(){return s.a.redirectToLogin()},children:"Login with Twitch"})})]}),Object(d.jsx)(r.Suspense,{fallback:Object(d.jsx)("div",{}),children:Object(d.jsx)(u.a,{basename:"/twitch-clip-queue/",children:Object(d.jsxs)(o.d,{children:[Object(d.jsx)(o.b,{exact:!0,path:"/",children:t?Object(d.jsx)(p,{}):Object(d.jsx)(f,{})}),Object(d.jsx)(o.b,{path:"*",children:Object(d.jsx)(o.a,{to:"/"})})]})})}),Object(d.jsxs)("footer",{className:"text-xs mt-4",children:["Created by ",Object(d.jsx)("span",{className:"font-bold",children:"JakeMiki"})]})]})},b=function(t){t&&t instanceof Function&&n.e(5).then(n.bind(null,76)).then((function(e){var n=e.getCLS,r=e.getFID,c=e.getFCP,a=e.getLCP,i=e.getTTFB;n(t),r(t),c(t),a(t),i(t)}))};i.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(h,{})}),document.getElementById("root")),b(),s.a.processAuth()},9:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return l})),n.d(e,"g",(function(){return f})),n.d(e,"f",(function(){return p})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return b})),n.d(e,"b",(function(){return v}));var r=n(1),c=n.n(r),a=n(5),i=n(15),u=n(16),o=n(25),s=Object(i.a)(!1),l=Object(i.a)(null),d=Object(i.a)(null),f=Object(i.a)(null),p=Object(i.a)(null),h=function(t,e,n){l.set(t),d.set(e),f.set(n),p.set(n),s.set(!0)},b=function(){var t=Object(a.a)(c.a.mark((function t(){var e;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=l.get(),l.set(null),d.set(null),f.set(null),p.set(null),s.set(!1),!e){t.next=9;break}return t.next=9,u.a.revokeToken(e);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=function(t){o.a.leaveChannel(p.get()),p.set(t),o.a.joinChannel(t)}}},[[73,1,2]]]);
//# sourceMappingURL=main.fd12d9de.chunk.js.map